---
title: "West Africa"
author: "Bbosa Robert"
date: "6/17/2020"
output:
  pdf_document: 
    toc: yes
    fig_caption: yes
    number_sections: yes
  html_document: default
  word_document: 
    toc: yes
    fig_caption: yes
---


```{r eval=FALSE, include=FALSE}
install.packages('tinytex')
update.packages(ask = FALSE, checkBuilt = TRUE)
tinytex::tlmgr_update()
tinytex::reinstall_tinytex()
tinytex:::is_tinytex()
```


# Install the necessary packages
```{r}
library(tidyverse)
library(plotly)
library(ggplot2)
library(dplyr)
library(viridis)
library(patchwork)
library(ggpubr)
library(hrbrthemes)
library(directlabels)
library(knitr)
library(pastecs)
library (RColorBrewer)
display.brewer.all()
```



# Read the file
```{r}
WA_global <- read.csv("~/COVID-19/COVID-19_Data/coronavirus.csv", 
                          header = TRUE, stringsAsFactors = FALSE)
attach(WA_global)
summary(WA_global)
names(WA_global)
str(WA_global)
```


# Eliminate the unnecessary columns
```{r}
WA_global <- select(WA_global, -Province.State, -Lat, -Long)
class(WA_global)
head(WA_global)
```


# Transfor date from "Character format to date format"
```{r}
WA_global <- rename(WA_global, country = Country.Region)
myformat <- "%Y-%m-%d"
WA_global$date <- as.Date(WA_global$date, myformat)
str(WA_global)
```


# Check if the date has changed
```{r}
WA_global <- tbl_df(WA_global)
class(WA_global)
str(WA_global)
```


# Include a column for totals
```{r}
WA_global_total <- WA_global %>%
  group_by(country, type ) %>%
  mutate(total_cases = cumsum(cases))
head(WA_global_total)
tail(WA_global_total)
```


# Select Eastern Africa countries
```{r}
WA_countries <- WA_global_total %>% 
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin", "Gambia", "Mauritania", "Senegal","Cote d'Ivoire","Sierra Leone","Mali","Liberia"))
 
head(WA_countries)
tail(WA_countries)
```


# Compute the infection rate

```{r}
confirmed_cases_WA <- WA_countries %>% 
  filter(type=="confirmed") %>%
  group_by(country,type) %>%
  mutate(infection_rate=ifelse(country=="Ghana",
                               total_cases*(1000000/31072940),
                        ifelse(country=="Nigeria",
                               total_cases*(1000000/206139589),
                        ifelse(country=="Niger",  
                               total_cases*(1000000/24206644),
                        ifelse(country=="Cabo Verde",
                               total_cases*(1000000/555987),
                        ifelse(country=="Guinea-Bissau",
                               total_cases*(1000000/1968001),
                        ifelse(country=="Guinea",
                               total_cases*(1000000/13132795),
                        ifelse(country=="Burkina Faso",
                               total_cases*(1000000/20903273),
                        ifelse(country=="Togo",
                               total_cases*(1000000/8278724),
                        ifelse(country=="Benin",
                               total_cases*(1000000/12123200),
                        ifelse(country=="Gambia",
                               total_cases*(1000000/2416668),
                        ifelse(country=="Mauritania",  
                               total_cases*(1000000/4649658),
                        ifelse(country=="Senegal",
                               total_cases*(1000000/16743927),
                        ifelse(country=="Cote d'Ivoire",
                               total_cases*(1000000/26378274),
                        ifelse(country=="Mali",
                               total_cases*(1000000/20250833),
                        ifelse(country=="Sierra Leona",
                               total_cases*(1000000/7976983),       
                               total_cases*(1000000/5057681)))))))))))))))))    
head(confirmed_cases_WA)
tail(confirmed_cases_WA)
str(confirmed_cases_WA)
summary(confirmed_cases_WA$infection_rate)
stat.desc(confirmed_cases_WA)
```


# Fatality rate

```{r}
death_cases_WA <- WA_countries %>% 
  filter(type %in% c("death", "confirmed")) %>% 
  select(-total_cases) %>% 
  spread(type, cases) %>% 
  mutate(fatality_rate=ifelse(country=="Ghana",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Nigeria",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Niger",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Cabo Verde",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Guinea-Bissau",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Guinea",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Bukina Faso",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Togo",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Benin",
                              round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Gambia",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Mauritania",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Senegal",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Cote d'Ivoire",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Mali", 
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Sierra Leona",
                             round((cumsum(death)/cumsum(confirmed))*100,digits=2),
                             round((cumsum(death)/cumsum(confirmed))*100,
                                   digits=2)))))))))))))))))

head(death_cases_WA)
tail(death_cases_WA)
str(death_cases_WA)
stat.desc(death_cases_WA)
```

# Recovery rate 

```{r}
recovered_cases_WA <- WA_countries %>% 
  filter(type %in% c("recovered","confirmed")) %>% 
   select(-total_cases) %>% 
  spread(type, cases) %>%
  mutate(recovery_rate=ifelse(country=="Angola",
                           round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Nigeria",
                           round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Niger",
                           round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Cabo Verde",
                           round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Guinea-Bissau",
                           round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Guinea",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Bukina Faso",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Togo",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Benin",
                              round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Gambia",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Mauritania",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Senegal",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Cote d'Ivoire",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Mali", 
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                       ifelse(country=="Sierra Leona",
                             round((cumsum(recovered)/cumsum(confirmed))*100,digits=2),
                             round((cumsum(recovered)/cumsum(confirmed))*100,
                                   digits=2)))))))))))))))))

head(recovered_cases_WA)
tail(recovered_cases_WA)
str(recovered_cases_WA)
stat.desc(recovered_cases_WA)
```


# Plot a bar chart

```{r}
nb.colors <- 16
mycolors <- colorRampPalette(brewer.pal(12, "Paired"))(nb.colors)

WA_countries %>% 
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"), type=="confirmed",
         date=="2020-06-15" ) %>% 
   ggplot( aes(country, total_cases, fill=country)) +
  geom_bar(aes(reorder(country, total_cases),total_cases),
            stat= "identity", show.legend = FALSE) +
  geom_text(aes(label= total_cases), vjust=0.5, hjust=-0.1, colour="black") +
 scale_fill_manual(values = mycolors) +
  coord_flip() +
  ggtitle("Comparison of comfirmed cases as at 15 June 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
   xlab("Country")+
  ylab("Number of Confirmed cases as at 15 June 2020")
 
 ggsave("confirmed_WA1.png",
       width =30, height = 15, units = "cm", dpi = 70)
```


# Plot a line graph as at 30 April

```{r}

confirmed_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea","Guinea-Bissau",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-05-01") %>%
  ggplot( aes(x=date, y=infection_rate, group=country, color=country)) +
  geom_line() +
  geom_dl(aes(label = country), 
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
  scale_fill_manual(values = mycolors) +
  ggtitle("Comparison of infection rate at 30 April 2020 ") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("infection rate per 1 million population")+
  xlab("Date") +
  scale_x_date(limits = as.Date(c("2020-03-01","2020-06-20")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, 
                                   size = 10, face = "bold"))

ggsave("confirmed_WA2.png", #other supported files;- "eps", "ps", "tex"                                 # (pictex),"pdf","jpeg", "tiff","bmp", "svg" or "wmf".
width =30, height = 15,
units = "cm", # other options c("in", "cm", "mm")
dpi = 70)
```
# Plot a line graph as at 31 May

```{r}

confirmed_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea","Guinea-Bissau",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-06-01") %>%
  ggplot( aes(x=date, y=infection_rate, group=country, color=country)) +
  geom_line() +
  geom_dl(aes(label = country), 
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
  scale_fill_manual(values = mycolors) +
  ggtitle("Comparison of infection rate at 31 May 2020 ") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("infection rate per 1 million population")+
  xlab("Date") +
  scale_x_date(limits = as.Date(c("2020-02-27","2020-06-20")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-02-15","2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30","2020-05-15",
                                "2020-05-31"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, 
                                   size = 10, face = "bold"))

ggsave("confirmed_WA3.png", #other supported files;- "eps", "ps", "tex"                                 # (pictex),"pdf","jpeg", "tiff","bmp", "svg" or "wmf".
width =30, height = 15,
units = "cm", # other options c("in", "cm", "mm")
dpi = 70)
```

# Plot a line graph as at 15 June

```{r}

confirmed_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea","Guinea-Bissau",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-06-16") %>%
  ggplot( aes(x=date, y=infection_rate, group=country, color=country)) +
  geom_line() +
  geom_dl(aes(label = country), 
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
  scale_fill_manual(values = mycolors) +
  ggtitle("Comparison of infection rate at 15 June 2020 ") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("infection rate per 1 million population")+
  xlab("Date") +
  scale_x_date(limits = as.Date(c("2020-02-27","2020-06-30")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-02-15","2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30","2020-05-15",
                                "2020-05-31","2020-06-15"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, 
                                   size = 10, face = "bold"))

ggsave("confirmed_WA4.png", #other supported files;- "eps", "ps", "tex"                                 # (pictex),"pdf","jpeg", "tiff","bmp", "svg" or "wmf".
width =30, height = 15,
units = "cm", # other options c("in", "cm", "mm")
dpi = 70)
```


# Plot a bar graph for the deaths 

```{r}
WA_countries %>% 
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"), type=="death",
         date=="2020-06-15" ) %>% 
   ggplot( aes(country, total_cases, fill=country)) +
  geom_bar(aes(reorder(country, total_cases),total_cases),
            stat= "identity", show.legend = FALSE) +
  geom_text(aes(label= total_cases), vjust=0.5, hjust=-0.1, colour="black") +
 scale_fill_manual(values = mycolors) +
  coord_flip() +
  ggtitle("Comparison of death as at 15 June 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
   xlab("Country")+
  ylab("Number of Confirmed cases as at 15 June 2020")
 
 ggsave("death_WA1.png",
       width =30, height = 15, units = "cm", dpi = 70)
```

# Plot line graph for fatality rate as at 30 April 

```{r}
death_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-05-01") %>%
  ggplot( aes(x=date, y=fatality_rate, group=country, color=country)) +
  geom_line() +
   geom_dl(aes(label = country),
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
   scale_fill_manual(values = mycolors)  +
  ggtitle("Comprison of the fatality rate as at 30 April 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("fatality rate (% of confirmed cases)") +
  xlab("Date") +
  scale_y_continuous(limits = c(ymin= 0, 
                                ymax= max(death_cases_WA$fatality_rate)))+
   scale_x_date(limits = as.Date(c("2020-03-01","2020-06-20")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   hjust = 1, size = 10,  face = "bold"))

ggsave("death_WA2.png",
       width =30, height = 15,units = "cm",dpi = 70)
```


# Plot line graph for fatality rate as at 31 May 


```{r}
death_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-06-01") %>%
  ggplot( aes(x=date, y=fatality_rate, group=country, color=country)) +
  geom_line() +
   geom_dl(aes(label = country),
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
  scale_fill_manual(values = mycolors)  +
  ggtitle("Comprison of the fatality rate as at 31 May 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("fatality rate (% of confirmed cases)") +
  xlab("Date") +
  scale_y_continuous(limits = c(ymin= 0, 
                                ymax= max(death_cases_WA$fatality_rate)))+
   scale_x_date(limits = as.Date(c("2020-03-01","2020-06-20")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30","2020-05-15",
                                "2020-05-31"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   hjust = 1, size = 10,  face = "bold"))

ggsave("death_WA3.png",
       width =30, height = 15,units = "cm",dpi = 70)
```



# Plot line graph for fatality rate as at 15 June 

```{r}
death_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-06-16") %>%
  ggplot( aes(x=date, y=fatality_rate, group=country, color=country)) +
  geom_line() +
   geom_dl(aes(label = country),
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
  scale_fill_manual(values = mycolors)  +
  ggtitle("Comprion of the fatality rate as at 15 June 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("fatality rate (% of confirmed cases)") +
  xlab("Date") +
  scale_y_continuous(limits = c(ymin= 0, 
                                ymax= max(death_cases_WA$fatality_rate)))+
   scale_x_date(limits = as.Date(c("2020-03-01","2020-06-30")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30","2020-05-15",
                                "2020-05-31","2020-06-15"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   hjust = 1, size = 10,  face = "bold"))

ggsave("death_WA4.png",
       width =30, height = 15,units = "cm",dpi = 70)
```


# Plot the bar chart for recoveries

```{r}
WA_countries %>% 
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"), type=="recovered",
         date=="2020-06-15" ) %>% 
   ggplot( aes(country, total_cases, fill=country)) +
  geom_bar(aes(reorder(country, total_cases),total_cases),
            stat= "identity", show.legend = FALSE) +
  geom_text(aes(label= total_cases), vjust=0.5, hjust=-0.1, colour="black") +
 scale_fill_manual(values = mycolors) +
  coord_flip() +
  ggtitle("Comparison of recovered cases as at 15 June 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
   xlab("Country")+
  ylab("Number of Confirmed cases as at 15 June 2020")
 
 ggsave("recovered_WA1.png",
       width =30, height = 15, units = "cm", dpi = 70)
```

# Plot a line graph for recovery rate as at 30 April

```{r}
recovered_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-05-01") %>%
  ggplot( aes(x=date, y=recovery_rate, group=country, color=country)) +
  geom_line() +
   geom_dl(aes(label = country),
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
   scale_fill_manual(values = mycolors)  +
  ggtitle("Comprion of the recovery rate as at 30 April 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("fatality rate (% of confirmed cases)") +
  xlab("Date") +
  scale_y_continuous(limits = c(ymin= 0, 
                                ymax= max(recovered_cases_WA$recovery_rate)))+
   scale_x_date(limits = as.Date(c("2020-03-01","2020-06-20")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   hjust = 1, size = 10,  face = "bold"))

ggsave("recovered_WA2.png",
       width =30, height = 15,units = "cm",dpi = 70)
```

# Plot a line graph for recovery rate as at 31 May

```{r}
recovered_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-06-01") %>%
  ggplot( aes(x=date, y=recovery_rate, group=country, color=country)) +
  geom_line() +
   geom_dl(aes(label = country),
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
   scale_fill_manual(values = mycolors)  +
  ggtitle("Comprion of the recovery rate as at 31 May 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("fatality rate (% of confirmed cases)") +
  xlab("Date") +
  scale_y_continuous(limits = c(ymin= 0, 
                                ymax= max(recovered_cases_WA$recovery_rate)))+
   scale_x_date(limits = as.Date(c("2020-03-01","2020-06-30")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30","2020-05-15",
                                "2020-05-31"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   hjust = 1, size = 10,  face = "bold"))

ggsave("recovered_WA3.png",
       width =30, height = 15,units = "cm",dpi = 70)
```


# Plot a line graph for recovery rate as at 15 June


```{r}
recovered_cases_WA %>%
  filter(country %in% c("Ghana","Nigeria","Niger","Guinea-Bissau","Guinea",
                        "Cabo Verde","Burkina Faso", "Togo", "Benin","Gambia",
                        "Mauritania","Senegal","Cote d'Ivoire",
                        "Sierra Leone","Mali","Liberia"),date<"2020-06-15") %>%
  ggplot( aes(x=date, y=recovery_rate, group=country, color=country)) +
  geom_line() +
   geom_dl(aes(label = country),
          method = list(dl.trans(x = x + 0.1), "last.polygons")) +
   scale_fill_manual(values = mycolors)  +
  ggtitle("Comprion of the recovery rate as at 15 June 2020") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylab("fatality rate (% of confirmed cases)") +
  xlab("Date") +
  scale_y_continuous(limits = c(ymin= 0, 
                                ymax= max(recovered_cases_WA$recovery_rate)))+
   scale_x_date(limits = as.Date(c("2020-03-01","2020-06-30")),
               date_labels = ("%b %d"),
               breaks = as.Date(c("2020-03-01","2020-03-15","2020-03-30",
                                  "2020-04-15","2020-04-30","2020-05-15",
                                "2020-05-31","2020-06-15"))) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   hjust = 1, size = 10,  face = "bold"))

ggsave("recovered_WA4.png",
       width =30, height = 15,units = "cm",dpi = 70)
```





```{r}
writexl::write_xlsx(x = confirmed_cases_WA, path = "C:/Users/uganda/Documents/COVID-19/COVID-19_Data/confirmed_cases_WA.xlsx", 
                    col_names = TRUE)

write.csv(confirmed_cases_WA, "C:/Users/uganda/Documents/COVID-19/COVID-19_Data/confirmed_cases_WA.csv", 
          row.names = FALSE)

writexl::write_xlsx(x = recovered_cases_WA, path = "C:/Users/uganda/Documents/COVID-19/COVID-19_Data/recovered_cases_WA.xlsx", 
                    col_names = TRUE)

write.csv(recovered_cases_WA, "C:/Users/uganda/Documents/COVID-19/COVID-19_Data/recovered_cases_WA.csv", 
          row.names = FALSE)


writexl::write_xlsx(x = death_cases_WA, path = "C:/Users/uganda/Documents/COVID-19/COVID-19_Data/death_cases_WA.xlsx", 
                    col_names = TRUE)

write.csv(death_cases_WA, "C:/Users/uganda/Documents/COVID-19/COVID-19_Data/death_cases_WA.csv", 
          row.names = FALSE)

```

